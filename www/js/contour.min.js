/*! Contour - v0.9.84 - 2014-04-21 */
!function(a){var b=this;if("object"==typeof module&&module&&"object"==typeof module.exports&&"function"==typeof require&&(b.d3=require("d3"),b._=require("lodash")),!d3)throw new Error("You need to include d3.js before Contour. Go to http://d3js.org/");if(!_||!_.merge)throw new Error("You need to include lodash.js before Contour. Go to http://lodash.com/");!function(){var b={getValue:function(a,b,c,d){return d=Array.prototype.slice.call(arguments,3),a?"function"==typeof a?a.apply(c,d):a:b},seriesNameToClass:function(a){return a||""}},c={warn:function(a){console&&console.log&&console.log(a)}},d={firstAndLast:function(a){return[a[0],a[a.length-1]]},roundToNearest:function(a,b){return Math.ceil(a/b)*b},clamp:function(a,b,c){return a>c?c:b>a?b:a},clampLeft:function(a,b){return b>a?b:a},clampRight:function(a,b){return a>b?b:a},degToRad:function(a){return a*Math.PI/180},radToDeg:function(a){return 180*a/Math.PI},linearRegression:function(a){for(var b={},c=a.length,d=0,e=0,f=0,g=0,h=0,i=0;c>i;i++)d+=a[i].x,e+=a[i].y,f+=a[i].x*a[i].y,g+=a[i].x*a[i].x,h+=a[i].y*a[i].y;return b.slope=(c*f-d*e)/(c*g-d*d),b.intercept=(e-b.slope*d)/c,b.r2=Math.pow((c*f-d*e)/Math.sqrt((c*g-d*d)*(c*h-e*e)),2),b},niceRound:function(a){return Math.ceil(a+.1*a)}},e={textBounds:function(a,b){var c=document.getElementsByTagName("body")[0],d=document.createElement("span"),e=document.createElement("span");d.className="contour-chart",e.style.position="absolute",e.style.width="auto",e.style.height="auto",e.style.visibility="hidden",e.style.lineHeight="100%",e.style.whiteSpace="nowrap",e.innerHTML=a,e.className=b.replace(/\./g," "),d.appendChild(e),c.appendChild(d);var f={width:e.clientWidth,height:e.clientHeight};return d.removeChild(e),c.removeChild(d),f}},f={dateDiff:function(a,b){var c=a.getTime()-b.getTime();return c/864e5}},g={merge:function(a,b){return"number"==typeof a&&(a=[a]),"number"==typeof b&&(b=[b]),a&&a.length?b&&b.length?[].concat(a,b).sort(function(a,b){return a-b}):a:b},normalizeSeries:function(a,b){function c(a,b){return a.x-b.x}function d(a,d){var f={name:d,data:_.map(a,function(a,c){var d=null!=a&&a.hasOwnProperty("x"),f=function(a){return null!=a?a:null};return d?_.extend(a,{x:a.x,y:f(a.y)}):{x:e?b[c]+"":c,y:f(a)}})};return e||f.data.sort(c),f}var e=!(!b||!_.isArray(b)),f=_.isArray(a)&&_.all(a,function(a){return a.hasOwnProperty("x")&&a.hasOwnProperty("y")}),g=_.isArray(a)&&_.isObject(a[0])&&a[0].hasOwnProperty("data")&&a[0].hasOwnProperty("name")&&_.all(a[0].data,function(a){return a.hasOwnProperty("x")&&a.hasOwnProperty("y")});return g?a:f?(e||a.sort(c),[{name:"series 1",data:a}]):_.isArray(a)?_.isObject(a[0])&&a[0].hasOwnProperty("data")||_.isArray(a[0])?_.map(a,function(a,b){return d(a.data?a.data:a,a.name?a.name:"series "+(b+1))}):[d(a,"series 1")]:a},uniq:function(a){for(var b={},c=[],d=a.length,e=0;d>e;e++){var f=a[e],g=f+"";b.hasOwnProperty(g)||(b[g]=!0,c.push(f))}return c},maxTickValues:function(a,b){var c=b.length,d=[];if(a>=c)return b.slice();for(var e=Math.ceil(c/a),f=0;c>f;)d.push(b[f]),f+=e;return d},isSupportedDataFormat:function(a){return _.isArray(a)&&_.isObject(a[0])&&a[0].hasOwnProperty("data")||_.isArray(a[0])}},h={extractScaleDomain:function(a,b,c){var d=_.max(a),e=_.min(a);return null==b&&null==c?[e,d]:null==b?[Math.min(e,c),c]:null==c?[b,Math.max(b,d)]:[b,c]}},i={selectDom:function(a){return d3.select(a)[0][0]},getStyle:function(b,c){if(!b)return a;var d="string"==typeof b?this.selectDom(b):b,e=d.offsetParent?d.ownerDocument.defaultView.getComputedStyle(d,null):d.style;return c?e[c]:e}},j={warning:function(a){console&&console.log&&console.log("WARNING: "+a)}};_.nw=_.extend({},_.nw,d,g,e,f,h,j,i,b,c)}(),function(){function b(a){return this.init(a),this}var c,d=this,e={chart:{animations:{enable:!0,duration:400},defaultWidth:400,defaultAspect:1/1.61803398875,width:a,height:a,margin:{top:0,right:0,bottom:0,left:0},padding:{top:null,right:null,bottom:null,left:null},internalPadding:{bottom:0,left:0},rotatedFrame:!1,plotWidth:a,plotHeight:a,plotTop:a,plotLeft:a},xAxis:{},yAxis:{},tooltip:{}};b.export=function(d,e){function f(a){if(!a||!a.length)return[];a[0].data&&_.each(a,f);var b=_.isObject(a[0])&&_.isDate(a[0].x),c=function(a,b){return a.x-b.x};return b&&a.sort(c),a}if("function"!=typeof e)throw new Error("Invalid render function for "+d+" visualization");b.prototype[d]=function(g,h){var i,j=this.options?this.options.xAxis?this.options.xAxis.categories:a:a,k=_.extend({},this.options[d],h);return g=g||c||[],f(g),i=new b.VisualizationContainer(_.nw.normalizeSeries(g,j),k,d,e,this),this._visualizations.push(i),c=g,this}},b.expose=function(a,c){var d=function(){var b="function"==typeof c?new c:c;return _.extend(this,_.omit(b,"init")),b.init&&b.init.call(this,this.options),this._exposed.push(a),this};return b.prototype[a]=d,this},b.prototype=_.extend(b.prototype,{_visualizations:a,_extraOptions:a,_exposed:a,init:function(a){return this.options=a||{},this._extraOptions=[],this._visualizations=[],this._exposed=[],this},calculateWidth:function(){var a=_.nw.getStyle(this.options.el,"width");return this.options.el?parseInt(a,10)||this.options.chart.defaultWidth:this.options.chart.defaultWidth},calculateHeight:function(){var b=_.nw.getStyle(this.options.el,"height"),c=this.options.el?parseInt(b,10):a,d=this.options.chart.width,e=this.options.chart.aspect||this.options.chart.defaultAspect;return c&&c>1?c:Math.round(d*e)},calcMetrics:function(){var a=this.options;this.adjustPadding(),this.adjustTitlePadding(),a.chart.width=a.chart.width||this.calculateWidth(),a.chart.height=a.chart.height||this.calculateHeight(),this.options=_.merge(a,{chart:{plotWidth:a.chart.width-a.chart.margin.left-a.chart.margin.right-a.chart.internalPadding.left-a.chart.padding.right,plotHeight:a.chart.height-a.chart.margin.top-a.chart.margin.bottom-a.chart.padding.top-a.chart.internalPadding.bottom,plotLeft:a.chart.margin.left+a.chart.internalPadding.left,plotTop:a.chart.margin.top+a.chart.padding.top}})},adjustPadding:function(){return this},adjustTitlePadding:function(){return this},composeOptions:function(){var a=_.merge({},e),b=function(b){_.merge(a,b)},c=function(b){_.merge(a,b.renderer.defaults)};_.each(this._extraOptions,b),_.each(this._visualizations,c),this.options=_.merge({},a,this.options)},baseRender:function(){return this.plotArea(),this},render:function(){return this.composeOptions(),this.calcMetrics(),this.baseRender(),this.renderVisualizations(),this},update:function(){return this.calcMetrics(),this},plotArea:function(){var a=this.options.chart;return this.container=d3.select(this.options.el),this.container.attr("style","-webkit-backface-visibility: hidden;"),this.svg||(this.svg=this.container.append("svg").attr("viewBox","0 0 "+a.width+" "+a.height).attr("preserveAspectRatio","xMinYMin").attr("class","contour-chart").attr("height",a.height).append("g").attr("transform","translate("+a.margin.left+","+a.margin.top+")")),this},createVisualizationLayer:function(a,b){return this.svg.append("g").attr("vis-id",b).attr("vis-type",a.type).attr("transform","translate("+this.options.chart.internalPadding.left+","+this.options.chart.padding.top+")")},renderVisualizations:function(){return _.each(this._visualizations,function(a,b){var c=b+1,d=a.layer||this.createVisualizationLayer(a,c),e=_.merge({},this.options,a.options);a.layer=d,a.parent=this,a.render(d,e,this)},this),this},checkDependencies:function(a){a=_.isArray(a)?a:[a];var b=this,c=[];if(_.each(a,function(a){-1===b._exposed.indexOf(a)&&c.push(a)}),c.length)throw new Error("ERROR: Missing depeendencies in the Contour instance (ej. new Contour({}).cartesian())\n The missing dependencies are: ["+c.join(", ")+"]\nGo to http://forio.com/contour/documentation.html#key_concepts for more information")},setData:function(a){return _.invoke(this._visualizations,"setData",a),this},select:function(a){return this._visualizations[a]},data:function(){}}),d.Contour=b}(),function(){function b(a,b){var c=b.chart.rotatedFrame?b.chart.plotWidth:b.chart.plotHeight,d=b.chart.rotatedFrame?[0,c]:[c,0];return a.range(d)}var c=function(a,b){this.data=a,this.options=b};c.prototype={axis:function(){var a=this.options.yAxis,b=this._scale.domain(),c=a.tickValues,d=this.numTicks(b,a.min,a.max),e=a.labels.formatter||d3.format(a.labels.format);return d3.svg.axis().scale(this._scale).tickFormat(e).tickSize(a.innerTickSize,a.outerTickSize).tickPadding(a.tickPadding).ticks(d).tickValues(c)},scale:function(a){return this._scale||(this._scale=d3.scale.linear(),this.setDomain(a),b(this._scale,this.options)),this._scale},setDomain:function(a){return this._scale.domain(a),this._niceTheScale(),this._scale},update:function(a,b){this.data=b,this.setDomain(a)},numTicks:function(){return null!=this.options.yAxis.ticks?this.options.yAxis.ticks:a},_niceTheScale:function(){this.options.yAxis.nicing&&this._scale.nice()}},_.extend(_.nw,{YAxis:c})}(),function(){var b={chart:{gridlines:"none",padding:{top:6,right:5,bottom:a,left:a}},xAxis:{type:null,categories:a,innerTickSize:6,outerTickSize:0,tickPadding:6,maxTicks:a,ticks:a,tickValues:a,title:a,titlePadding:4,innerRangePadding:.1,outerRangePadding:.1,firstAndLast:!1,orient:"bottom",labels:{format:a,formatter:a},linearDomain:!1},yAxis:{min:a,max:a,smartAxis:!1,innerTickSize:6,outerTickSize:6,tickPadding:4,tickValues:a,ticks:a,title:a,titlePadding:4,nicing:!0,orient:"left",labels:{verticalAlign:"middle",format:"s",formatter:a}}},c=function(){return{dataSrc:[],init:function(c){var d={chart:{rotatedFrame:!1,internalPadding:{bottom:a,left:a}}};this.options=c||{},_.merge(this.options,d);var e={};return this.options.xAxis&&this.options.xAxis.firstAndLast||(e={chart:{padding:{right:15}}}),this._extraOptions.push(_.merge({},b,e)),this},xDomain:[],yDomain:[],_getYScaledDomain:function(){var b=this.yDomain&&this.yDomain[0]>0?0:a;return _.nw.extractScaleDomain(this.yDomain,this.options.yAxis.min||b,this.options.yAxis.max)},adjustPadding:function(){var a=this.options.xAxis,b=this.options.yAxis,c=function(a){return Math.max(a.outerTickSize||0,a.innerTickSize||0)};if(null==this.options.chart.padding.bottom)if(0!==a.ticks){var d=this.xDomain,e=d.join("<br>"),f=_.nw.textBounds(e,".x.axis"),g=_.nw.textBounds("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890",".x.axis"),h=g.height,i=a.labels&&a.labels.rotation?a.labels.rotation%360:0,j=0===i?g.height:Math.ceil(Math.abs(f.width*Math.sin(_.nw.degToRad(i)))+h/5);this.options.chart.internalPadding.bottom=this.options.chart.padding.bottom||c(this.options.xAxis)+(this.options.xAxis.tickPadding||0)+j}else this.options.chart.internalPadding.bottom=c(this.options.xAxis)+(this.options.xAxis.tickPadding||0);else this.options.chart.internalPadding.bottom=this.options.chart.padding.bottom||0;if(null==this.options.chart.padding.left){var k=this._getYScaledDomain(),l=d3.scale.linear().domain(k),m=l.ticks(b.ticks),n=b.labels.formatter||d3.format(b.labels.format||",.0f"),o=_.map(m,n).join("<br>"),p=_.nw.textBounds(o,".y.axis");this.options.chart.internalPadding.left=this.options.chart.padding.left||c(this.options.yAxis)+(this.options.yAxis.tickPadding||0)+p.width}else this.options.chart.internalPadding.left=this.options.chart.padding.left},adjustTitlePadding:function(){var a;(this.options.xAxis.title||this.options.yAxis.title)&&(this.options.xAxis.title&&(a=_.nw.textBounds(this.options.xAxis.title,".x.axis-title"),this.options.chart.internalPadding.bottom+=a.height+this.options.xAxis.titlePadding),this.options.yAxis.title&&(a=_.nw.textBounds(this.options.yAxis.title,".y.axis-title"),this.options.chart.internalPadding.left+=a.height+this.options.yAxis.titlePadding))},computeXScale:function(){if(!this.xDomain)throw new Error("You are trying to render without setting data (xDomain).");this.xScale?(this.xScaleGenerator.update(this.xDomain,this.dataSrc),this.rangeBand=this.xScaleGenerator.rangeBand()):(this.xScaleGenerator=_.nw.xScaleFactory(this.dataSrc,this.options),this.xScale=this.xScaleGenerator.scale(this.xDomain),this.rangeBand=this.xScaleGenerator.rangeBand())},computeYScale:function(){if(!this.yDomain)throw new Error("You are trying to render without setting data (yDomain).");var a=this._getYScaledDomain();this.yScale?this.yScaleGenerator.update(a,this.dataSrc):(this.yScaleGenerator=_.nw.yScaleFactory(this.dataSrc,this.options,this.yMin,this.yMax),this.yScale=this.yScaleGenerator.scale(a))},xScale:a,yScale:a,setYDomain:function(a){this.yScaleGenerator.setDomain(a)},redrawYAxis:function(){this.svg.select(".y.axis").call(this.yAxis()),this.renderGridlines()},_animationDuration:function(){var a=this.options.chart.animations;return a&&a.enable?null!=a.duration?a.duration:400:0},computeScales:function(){return this.computeXScale(),this.computeYScale(),this},_xAxis:a,xAxis:function(){return this._xAxis||(this._xAxis=this.xScaleGenerator.axis().orient(this.options.xAxis.orient)),this._xAxis},_yAxis:a,yAxis:function(){return this._yAxis||(this._yAxis=this.yScaleGenerator.axis().orient(this.options.yAxis.orient)),this._yAxis},renderXAxis:function(){var a=this.xAxis(),b=this.options.chart.plotHeight+this.options.chart.padding.top;return this._xAxisGroup=this.svg.selectAll(".x.axis").data([1]),this._xAxisGroup.enter().append("g").attr("transform","translate("+this.options.chart.internalPadding.left+","+b+")").attr("class","x axis"),this._xAxisGroup.transition().duration(this._animationDuration()).call(a),this.xScaleGenerator.postProcessAxis(this._xAxisGroup),this},renderYAxis:function(){var a=this.options.yAxis,b={bottom:".8em",middle:".35em",top:"0"},c=this.options.chart.internalPadding.left,d=this.options.chart.padding.top;return this._yAxisGroup=this.svg.selectAll(".y.axis").data([1]),this._yAxisGroup.enter().append("g").attr("transform","translate("+c+","+d+")").attr("class","y axis"),this._yAxisGroup.transition().duration(this._animationDuration()).call(this.yAxis()).selectAll(".tick text").attr("dy",b[a.labels.verticalAlign]),this},renderAxisLabels:function(){.25*this.titleOneEm;var a,b,c,d=40/46.609;return this.options.xAxis.title&&(a=_.nw.textBounds(this.options.xAxis.title,".x.axis-title"),c=this.options.chart.internalPadding.bottom,b=0,el=this._xAxisGroup.selectAll(".x.axis-title").data([1]),el.enter().append("text").attr("class","x axis-title").attr("x",b).attr("y",c).attr("dx",(this.options.chart.plotWidth-a.width)/2).attr("dy",-2).text(this.options.xAxis.title)),this.options.yAxis.title&&(a=_.nw.textBounds(this.options.yAxis.title,".y.axis-title"),c=-this.options.chart.internalPadding.left+a.height*d,b=0,el=this._yAxisGroup.selectAll(".y.axis-title").data([1]),el.enter().append("text").attr("class","y axis-title").attr("transform","rotate(-90)").attr("x",b).attr("y",c).attr("dx",-(this.options.chart.plotHeight+a.width)/2).attr("dy",0).text(this.options.yAxis.title)),this},renderGridlines:function(){function a(a,b){var c=a.tickValues();if(!c){var d=a.ticks()[0];return a.scale().ticks(d).slice(1)}return b&&c.pop(),c.slice(1)}function b(a){return a.tickValues()||(a.scale().ticks?a.scale().ticks().slice(1):a.scale().domain())}var c,d,e=this.options.chart.gridlines,f="horizontal"===e||"both"===e,g="vertical"===e||"both"===e,h=this.xScale,i=this.yScale;if(f){c=a(this.yAxis(),this.options.yAxis.smartAxis);var j=this.options.chart.plotWidth;d=this._yAxisGroup.selectAll(".grid-lines").data([c]),d.enter().append("svg:g").attr("class","grid-lines");var k=d.selectAll(".grid-line").data(function(a){return a});k.transition().duration(this._animationDuration()).attr("x1",0).attr("x2",function(){return j}).attr("y1",i).attr("y2",i),k.enter().append("line").attr("class","grid-line").attr("x1",0).attr("x2",function(){return j}).attr("y1",i).attr("y2",i),k.exit().remove()}if(g){this._xAxisGroup.select("g.grid-lines").remove(),d=this._xAxisGroup.append("svg:g").attr("class","grid-lines"),c=b(this.xAxis());var l=this.rangeBand/2,m=this.options.chart.plotHeight;d.selectAll(".grid-line").data(c).enter().append("line").attr("class","grid-line").attr("x1",function(a){return h(a)+l}).attr("x2",function(a){return h(a)+l}).attr("y1",-m).attr("y2",0)}return this},renderBackground:function(){var a=this.options.chart,b=this.createVisualizationLayer("background",0),c=b.selectAll(".plot-area-background").data([null]);return c.enter().append("rect").attr("class","plot-area-background").attr("x",0).attr("y",0).attr("width",a.plotWidth).attr("height",a.plotHeight),c.exit().remove(),this},render:function(){return this.composeOptions(),this.adjustDomain(),this.calcMetrics(),this.computeScales(),this.baseRender(),this.renderBackground().renderXAxis().renderYAxis().renderGridlines().renderAxisLabels().renderVisualizations(),this},datum:function(a,b){return _.isObject(a)&&_.isArray(a.data)?_.map(a.data,_.bind(this.datum,this)):{y:_.isObject(a)?a.y:a,x:_.isObject(a)?a.x:this.options.xAxis.categories?this.options.xAxis.categories[b]:b}},adjustDomain:function(){var a=this.getExtents();this.yDomain=a.length?a:[0,10],this.xDomain=this.getXDomain(),this.yMin=this.yDomain[0],this.yMax=this.yDomain[this.yDomain.length-1];var b=_.filter(this._visualizations,function(a){return _.nw.isSupportedDataFormat(a.data)});this.dataSrc=_.flatten(_.map(b,function(a){return _.flatten(_.map(a.data,_.bind(this.datum,this)))},this)),this._yAxis=null,this._xAxis=null},getExtents:function(a){var b=a&&"x"===a?"xExtent":"yExtent",c=_.filter(this._visualizations,function(a){return _.nw.isSupportedDataFormat(a.data)}),d=_.flatten(_.pluck(c,b));return d.length?d3.extent(d):[]},getXDomain:function(){var a=_.filter(this._visualizations,function(a){return _.nw.isSupportedDataFormat(a.data)}),b=_.nw.uniq(_.flatten(_.pluck(a,"xDomain")));return b}}};Contour.expose("cartesian",c)}(),Contour.version="0.9.84",function(){var a={xScaleFactory:function(a,b){var c="time"===b.xAxis.type||(_.isArray(a)&&a.length>0&&a[0].data?a[0].data[0].x&&_.isDate(a[0].data[0].x):_.isArray(a)&&a.length>0&&a[0].x&&_.isDate(a[0].x));return c&&"ordinal"!==b.xAxis.type?new _.nw.TimeScale(a,b):b.xAxis.categories||"linear"!==b.xAxis.type?new _.nw.OrdinalScale(a,b):new _.nw.LinearScale(a,b)},yScaleFactory:function(a,b,c,d){var e={log:_.nw.LogYAxis,smart:_.nw.SmartYAxis,linear:_.nw.YAxis};if(b.yAxis.type||(b.yAxis.type="linear"),"linear"===b.yAxis.type&&b.yAxis.smartAxis&&(b.yAxis.type="smart"),!e[b.yAxis.type])throw new Error('Unknown axis type: "'+b.yAxis.type+'"');return new e[b.yAxis.type](a,b,c,d)}};_.nw=_.extend({},_.nw,a)}(),function(){function a(a,b){this.options=b,this.data=a,this.init()}a.prototype={init:function(){delete this._scale},scale:function(a){return this._domain=a?this._getAxisDomain(a):this._getAxisDomain(this.data),this._scale?this._scale.domain(this._domain):(this._scale=d3.scale.linear().domain(this._domain),null==this.options.xAxis.min&&null==this.options.xAxis.max&&this._scale.nice(),this._setRange()),this._scale},axis:function(){var a=this.options.xAxis,b=a.labels.formatter||d3.format(a.labels.format||"d"),c=d3.svg.axis().scale(this._scale).tickSize(a.innerTickSize,a.outerTickSize).tickPadding(a.tickPadding).tickFormat(function(a){return _.isDate(a)?a.getDate():b(a)});return a.firstAndLast?c.tickValues(_.nw.firstAndLast(this._domain)):a.tickValues?c.tickValues(a.tickValues):null!=a.ticks&&c.ticks(a.ticks),c},update:function(a,b){this.data=b,this.scale(a)},rangeBand:function(){return 1},postProcessAxis:function(){return this},_setRange:function(){var a=this.options.chart.rotatedFrame?this.options.chart.plotHeight:this.options.chart.plotWidth,b=this.options.chart.rotatedFrame?[a,0]:[0,a];return this._scale.range(b)},_getAxisDomain:function(a){var b=this.options.xAxis.min,c=this.options.xAxis.max,d=null!=b?this.options.xAxis.min:d3.min(a),e=null!=c?this.options.xAxis.max:d3.max(a);return null!=b&&null!=c&&b>c?d3.extent(a):[d,e]}},_.nw=_.extend({},_.nw,{LinearScale:a})}(),function(){function a(a,b){var c=b.chart.rotatedFrame?b.chart.plotWidth:b.chart.plotHeight,d=b.chart.rotatedFrame?[0,c]:[c,0];return a.range(d)}var b=function(a,b){this.data=a,this.options=b};b.prototype=_.extend({},_.nw.YAxis.prototype,{axis:function(){var a=this.options.yAxis,b=this._scale.domain(),c=Math.ceil(Math.log(b[1])/Math.log(10)),d=a.labels.formatter||d3.format(a.labels.format||",.0f"),e=d3.svg.axis().scale(this._scale).tickSize(a.innerTickSize,a.outerTickSize).tickPadding(a.tickPadding);return a.labels.formatter?e.tickFormat(a.labels.formatter):e.ticks(a.ticks||c,d),e},scale:function(b){return this._scale||(b[0]<=.1&&(b[0]=.1),this._scale=d3.scale.log(),this.setDomain(b).clamp(!0),a(this._scale,this.options)),this._scale},update:function(a,b){this.data=b,a[0]<=.1&&(a[0]=.1),this.setDomain(a).clamp(!0)}}),_.extend(_.nw,{LogYAxis:b})}(),function(){function a(a,b){this.options=b,this.data=a,this.init()}a.prototype={init:function(){this.isCategorized=!0,delete this._scale},scale:function(a){return this._scale||(this._scale=new d3.scale.ordinal,this._range()),this.setDomain(a),this._scale},axis:function(){var a=this.options.xAxis,b=a.labels.format?d3.format(a.labels.format):0,c=a.labels.formatter||(this.isCategorized?0:b)||function(a){return _.isDate(a)?a.getDate():a},d=d3.svg.axis().scale(this._scale).innerTickSize(a.innerTickSize).outerTickSize(a.outerTickSize).tickPadding(a.tickPadding).tickFormat(c);return a.firstAndLast?d.tickValues(_.nw.firstAndLast(this._domain)):a.maxTicks?d.tickValues(_.nw.maxTickValues(a.maxTicks,this._domain)):a.tickValues?d.tickValues(a.tickValues):null!=a.ticks?(d.ticks(a.ticks),0===a.ticks&&d.tickValues([])):d.tickValues(a.categories),d},postProcessAxis:function(a){var b=this.options.xAxis;if(b.labels&&null!=b.labels.rotation){var c=b.labels.rotation,d=_.nw.degToRad(c),e=c>0?1:0>c?-1:0,f=.71,g=Math.cos(d),h=Math.sin(d);b.labels.rotation>0;var i=b.labels.rotation<0?"end":b.labels.rotation>0?"start":"middle";a.selectAll(".tick text").style({"text-anchor":i}).attr("transform",function(){var a=d3.select(this).attr("x")||0,c=d3.select(this).attr("y")||0;return"rotate("+b.labels.rotation+" "+a+","+c+")"}).attr("dy",function(){return(g*f).toFixed(4)+"em"}).attr("dx",function(){return-(h*f-.31*e).toFixed(4)+"em"})}},update:function(a,b){this.data=b,this.setDomain(a)},setDomain:function(a){this._domain=a,this._scale.domain(a)},rangeBand:function(){var a=this._scale.rangeBand();return a||_.nw.warn("rangeBand is 0, you may have too many points in in the domain for the size of the chart (ie. chartWidth = "+this.options.chart.plotWidth+"px and "+this._domain.length+" X-axis points (plus paddings) means less than 1 pixel per band and there're no half pixels"),this._scale.rangeBand()},_range:function(){var a=this.options.chart.rotatedFrame?[this.options.chart.plotHeight,0]:[0,this.options.chart.plotWidth];return this.isCategorized?this._scale.rangeRoundBands(a,this.options.xAxis.innerRangePadding,this.options.xAxis.outerRangePadding):this._scale.rangePoints(a)}},_.nw=_.extend({},_.nw,{OrdinalScale:a})}(),function(){function a(a,b,c,d,e){var f=_.nw.merge(a,e);return null==b&&null==c?f:null==b?c>d?_.nw.merge([c],f):[c]:null==c?b>=e?[b]:(f[0]=b,f):_.nw.merge([b,c],e)}var b=function(a,b,c,d){this.data=a,this.options=b,this.yMax=d,this.yMin=c};b.prototype=_.extend({},_.nw.YAxis.prototype,{axis:function(){var b=this.options.yAxis,c=this._scale.domain(),d=a(c,b.min,b.max,this.yMin,this.yMax),e=this.numTicks(),f=_.nw.YAxis.prototype.axis.call(this);return f.ticks(e).tickValues(d)},numTicks:function(){return 3},setDomain:function(a){var b=d3.extent(a);this.yMin=b[0],this.yMax=b[1],this._scale.domain(a),this._niceTheScale()},_niceTheScale:function(){var a=this._scale.domain(),b=[this.options.yAxis.min||a[0],this.options.yAxis.max||_.nw.niceRound(a[1])];this._scale.domain(b)}}),_.extend(_.nw,{SmartYAxis:b})}(),function(){function a(a,b){if(!a||!b)return 0;var c=a.getTime()-b.getTime();return c/864e5}function b(a,b){this.options=b,this.data=a,this.init()}b.prototype={init:function(){delete this._scale},scale:function(a){return this._scale||(this._scale=new d3.time.scale,this.setDomain(a),this.range()),this._scale},axis:function(){var a=this.options.xAxis,b=this.getOptimalTickFormat(),c=d3.svg.axis().scale(this._scale).tickFormat(b).tickSize(a.innerTickSize,a.outerTickSize).tickPadding(a.tickPadding).tickValues(this._domain);return null!=this.options.xAxis.maxTicks&&this.options.xAxis.maxTicks<this._domain.length?c.tickValues(_.nw.maxTickValues(a.maxTicks,this._domain)):this.options.xAxis.firstAndLast&&c.tickValues(_.nw.firstAndLast(this._domain)),c},update:function(a,b){this.data=b,this.setDomain(a)},setDomain:function(a){this._domain=a;var b=this._getAxisDomain(this._domain);this._scale.domain(b)},postProcessAxis:function(a){if(this.options.xAxis.firstAndLast){var b=a.selectAll(".tick text")[0];d3.select(b[0]).style({"text-anchor":"start"}),d3.select(b[b.length-1]).style({"text-anchor":"end"})}},rangeBand:function(){return 4},getOptimalTickFormat:function(){if(this.options.xAxis.labels.formatter)return this.options.xAxis.labels.formatter;if(this.options.xAxis.labels.format)return d3.time.format(this.options.xAxis.labels.format);var b=Math.abs(a(this._domain[this._domain.length-1],this._domain[0])),c=this.options.xAxis.maxTicks||1;return c>b?d3.time.format("%H:%M"):365>b?d3.time.format("%d %b"):d3.time.format("%Y")},range:function(){var a=this._getAxisRange(this._domain);return this._scale.rangeRound(a,.1)},_getAxisDomain:function(a){return this.options.xAxis.linearDomain?a:d3.extent(a)},_getAxisRange:function(a){var b=this.options.chart.rotatedFrame?this.options.chart.plotHeight:this.options.chart.plotWidth;return this.options.xAxis.linearDomain?_.range(0,b,b/(a.length-1)).concat([b]):[0,b]}},_.nw=_.extend({},_.nw,{TimeScale:b})}(),function(){var a={chart:{rotatedFrame:!0},xAxis:{orient:"left"},yAxis:{orient:"bottom"}},b={init:function(){_.merge(this.options,a)},adjustPadding:function(){var a=this.options.xAxis.categories||_.pluck(this.dataSrc,"x"),b=a.join("<br>"),c=_.nw.textBounds(b,".x.axis"),d=_.nw.textBounds("ABC",".y.axis"),e=function(a){return Math.max(a.outerTickSize,a.innerTickSize)};this.options.chart.internalPadding.left=this.options.chart.padding.left||e(this.options.xAxis)+this.options.xAxis.tickPadding+c.width,this.options.chart.internalPadding.bottom=this.options.chart.padding.bottom||e(this.options.yAxis)+this.options.yAxis.tickPadding+d.height},adjustTitlePadding:function(){var a;(this.options.xAxis.title||this.options.yAxis.title)&&(this.options.xAxis.title&&(a=_.nw.textBounds(this.options.xAxis.title,".x.axis-title"),this.options.chart.internalPadding.left+=a.height+this.options.xAxis.titlePadding),this.options.yAxis.title&&(a=_.nw.textBounds(this.options.yAxis.title,".y.axis-title"),this.options.chart.internalPadding.bottom+=a.height+this.options.yAxis.titlePadding))},renderYAxis:function(){var a=this.yAxis(),b=this.options.chart.internalPadding.left,c=this.options.chart.padding.top+this.options.chart.plotHeight;return this._yAxisGroup=this.svg.selectAll(".y.axis").data([1]),this._yAxisGroup.enter().append("g").attr("class","y axis").attr("transform","translate("+b+","+c+")"),this._yAxisGroup.exit().remove(),this._yAxisGroup.transition().duration(this._animationDuration()).attr("transform","translate("+b+","+c+")").call(a),this},renderXAxis:function(){var a=this.options.chart.internalPadding.left,b=this.options.chart.padding.top,c=this.xAxis();return this._xAxisGroup=this.svg.selectAll(".x.axis").data([1]),this._xAxisGroup.enter().append("g").attr("class","x axis").attr("transform","translate("+a+","+b+")"),this._xAxisGroup.exit().remove(),this._xAxisGroup.transition().duration(this._animationDuration()).attr("transform","translate("+a+","+b+")").call(c),this.xScaleGenerator.postProcessAxis(this._xAxisGroup),this},renderAxisLabels:function(){var a,b,c,d,e,f,g=.25*this.titleOneEm,h=40/46.609;return this.options.xAxis.title&&(a=_.nw.textBounds(this.options.xAxis.title,".x.axis-title"),e=this.options.chart.rotatedFrame?-a.height:this.options.chart.plotWidth,f=this.options.chart.rotatedFrame?-this.options.chart.internalPadding.left:this.options.chart.internalPadding.bottom-g,c=this.options.chart.rotatedFrame?"-90":"0",this._xAxisGroup.append("text").attr("class","x axis-title").attr("x",0).attr("y",f).attr("transform",["rotate(",c,")"].join("")).attr("dy",a.height*h).attr("dx",-(this.options.chart.plotHeight+a.width)/2).text(this.options.xAxis.title)),this.options.yAxis.title&&(a=_.nw.textBounds(this.options.yAxis.title,".y.axis-title"),d=Math.max(this.options.yAxis.innerTickSize,this.options.yAxis.outerTickSize),b=this.options.chart.rotatedFrame?"end":"middle",e=this.options.chart.rotatedFrame?this.options.chart.plotWidth:0,f=this.options.chart.rotatedFrame?this.options.chart.internalPadding.bottom:-this.options.chart.internalPadding.left+this.titleOneEm-g,c=this.options.chart.rotatedFrame?"0":"-90",this._yAxisGroup.append("text").attr("class","y axis-title").attr("y",f).attr("x",e).attr("dx",-(this.options.chart.plotWidth+a.width)/2).attr("dy",-4).attr("transform",["rotate(",c,")"].join("")).text(this.options.yAxis.title)),this}};Contour.expose("horizontal",b)}(),function(){function a(a,b,c,d,e){this.type=c,this.renderer=d,this.ctx=e,this.init(a,b)}var b=function(a,b){var c=[],d=[];return _.each(a,function(a){if(a.data.length){var e=_.pluck(a.data,b);c.push(d3.max(e)),d.push(d3.min(e))}}),d.length&&c.length?[_.min(d),_.max(c)]:[]},c=function(a){for(var b=_.pluck(a,"data"),c=_.max(_.map(b,function(a){return a.length})),d=[],e=0;c>e;e++)_.each(b,function(a){d[e]=a[e]?(d[e]||0)+a[e].y:d[e]||0});return[_.min(d),_.max(d)]},d=_.partialRight(b,"x"),e=_.partialRight(b,"y");a.prototype={init:function(a,b){this.setOptions(b),this.setData(a)},render:function(a,b){return this.renderer.call(this.ctx,this.data,a,b),this.ctx},setData:function(a){return this.data=_.nw.normalizeSeries(a),this._updateDomain(),this.ctx},setOptions:function(a){var b={};return b[this.type]=a||{},this.options={},this.options=_.merge({},this.renderer.defaults||{},b),this.ctx},_updateDomain:function(){if(!this.options[this.type])throw new Error("Set the options before calling setData or _updateDomain");_.nw.isSupportedDataFormat(this.data)&&(this.xDomain=_.flatten(_.map(this.data,function(a){return _.pluck(a.data,"x")})),this.xExtent=d(this.data,"x"),this.yExtent=this.options[this.type].stacked?c(this.data):e(this.data))}},Contour.VisualizationContainer=a}(),function(){function a(a,b,c){function d(){var d=b.selectAll("g.series").data(k(a));d.enter().append("svg:g").attr("class",j).append("path").datum(function(a){return a.data}).attr("class","area").attr("d",l),d.exit().remove(),c.chart.animations&&c.chart.animations.enable?d.select(".area").datum(function(a){return a.data}).transition().duration(c.chart.animations.duration||f).attr("d",m):d.select(".area").datum(function(a){return a.data}).attr("d",m),c.tooltip.enable&&e.call(this,d)}function e(a){var b=10;a.append("g").attr("class","tooltip-trackers").selectAll("tooltip-tracker").data(function(a){return a.data}).enter().append("circle").attr("class","tooltip-tracker").attr("opacity",0).attr("r",b).attr("cx",function(a){return g(a.x)}).attr("cy",function(a){return h((c.area.stacked?a.y0:0)+a.y)})}this.checkDependencies("cartesian");var f=null!=c.chart.animations.duration?c.chart.animations.duration:400,g=_.bind(function(a){return this.xScale(a)+this.rangeBand/2+.5},this),h=_.bind(function(a){return this.yScale(a)+.5},this),i=c.chart.plotHeight,j=function(a,b){return"series s-"+(b+1)+" "+a.name},k=d3.layout.stack().values(function(a){return a.data}),l=d3.svg.area().x(function(a){return g(a.x)}).y0(function(){return i}).y1(function(){return i}),m=d3.svg.area().x(function(a){return g(a.x)}).y0(function(a){return c.area.stacked?h(a.y0||c.yAxis.min||0):h(0)}).y1(function(a){return h((c.area.stacked?a.y0:0)+a.y)});d()}var b={xAxis:{type:"linear"},area:{stacked:!0}};a.defaults=b,Contour.export("area",a)}(),function(){function a(a,b,c){function d(a,b){return a.attr("y",function(a){return h(a.x)}).attr("height",j),b?a.attr("x",function(){return i(0)
}).attr("width",function(){return 0}):a.attr("x",function(a){return a.y>=0?i(a.y0||0):i(a.y+a.y0)}).attr("width",function(a){return a.y>=0?i(a.y)-i(0):i(0)-i(a.y)})}function e(b,d){var e=a.length,f=function(){return j/e-c.bar.groupPadding+.5},g=function(a,b){return j/e*b+.5};return b.attr("y",function(a,b,c){return h(a.x)+g(a,c)}).attr("x",i(0)).attr("height",f),d?b.attr("width",function(){return.5}):b.attr("width",function(a){return a.y>=0?i(a.y)-i(0):i(0)-i(a.y)}).attr("x",function(a){return a.y<0?i(a.y):i(0)})}this.checkDependencies(["cartesian","horizontal"]);var f=null!=c.chart.animations.duration?c.chart.animations.duration:400,g=this,h=function(a){return g.xScale(a)-.5},i=function(a){return g.yScale(a)+.5},j=this.rangeBand,k=d3.layout.stack().values(function(a){return a.data}),l=c.bar.stacked?d:e,m=_.partialRight(l,!0),n=function(a,b){return"series s-"+(b+1)},o=b.selectAll("g.series").data(k(a));o.enter().append("svg:g").attr("class",n),o.exit().remove();var p=o.selectAll(".bar").data(function(a){return a.data}),q="bar"+(c.tooltip.enable?" tooltip-tracker":"");p.enter().append("rect").attr("class",q).call(m),c.chart.animations&&c.chart.animations.enable?(p.transition().duration(f).call(l),p.exit().transition().duration(f).attr("width",i(0)).remove()):(p.call(l),p.exit().remove())}var b={bar:{stacked:!1,groupPadding:2}};a.defaults=b,Contour.export("bar",a)}(),function(){function a(a,b,c){function d(a,b){var c=k(0);a.attr("x",function(a){return j(a.x)+m}).attr("width",function(){return n}),b?a.attr("y",function(a){return a.y>=0?c:c}).attr("height",function(){return.5}):a.attr("y",function(a){return a.y>=0?k(a.y)+k(a.y0)-c:k(a.y0)}).attr("height",function(a){return a.y>=0?c-k(a.y):k(a.y)-c})}function e(b,c){var d=n/a.length-g.groupPadding+.5,e=function(b,c){return n/a.length*c+.5},f=k(0);b.attr("x",function(a,b,c){return j(a.x)+e(a,c)+m}).attr("width",d),c?b.attr("y",f).attr("height",0):b.attr("y",function(a){return a.y>=0?k(a.y):f}).attr("height",function(a){return a.y>=0?f-k(a.y):k(a.y)-f})}this.checkDependencies("cartesian");var f=null!=c.chart.animations.duration?c.chart.animations.duration:400,g=c.column;c.chart.plotWidth;var h=c.chart.plotHeight,i=this,j=function(a){return Math.round(i.xScale(a))+.5},k=function(a){return Math.round(i.yScale(a))-.5},l=function(a){return a.data},m=_.nw.getValue(g.offset,0,this),n=_.nw.getValue(g.columnWidth,this.rangeBand,this),o=_.partialRight(c.column.stacked?d:e,!0),p=c.column.stacked?d:e,q=_.map(a,function(a){return{name:a.name,data:_.filter(a.data,function(b,c){return 0===c?!0:j(b.x)!==j(a.data[c-1].x)})}}),r=d3.layout.stack().values(function(a){return a.data}),s=b.selectAll("g.series").data(r(q));s.enter().append("g").attr("class",function(a,b){return"series s-"+(b+1)}),s.exit().remove();var t=s.selectAll(".column").data(l);n/a.length-g.groupPadding-.5;var u="column"+(c.tooltip.enable?" tooltip-tracker":"");t.enter().append("rect").attr("class",u).call(o),c.chart.animations&&c.chart.animations.enable?(t.exit().transition().duration(f).attr("y",h).attr("height",function(){return.5}).remove(),t.transition().duration(f).call(p)):(t.exit().remove(),t.call(p))}var b={column:{stacked:!1,groupPadding:1,columnWidth:function(){return this.rangeBand},offset:function(){return 0}}};a.defaults=b,Contour.export("column",a)}(),function(){Contour.export("coolNarwhal",function(a,b){b.append("path").attr("class","cool").attr("opacity",0).attr("transform","scale(.5) translate(500 150)").attr("d","M-220.02,76.509l-0.78,8.927c-0.956,10.949,1.389,20.422,6.188,30.383c10.203,21.173,63.095,84.05,93.72,115.075c20.145,20.406,19.487,23.018,21.549,40.122c2.487,20.621,24.897,66.462,40.838,71.269 c15.086,4.549,12.91-12.398,13.319-37.83c5.746,2.457,10.917,5.638,20.206,12.697c61.697,46.892,139.734,69.97,206.5,71.733c46.209,1.221,81.432-7.081,142.957-33.694c40.484-17.512,54.271-22.098,65.639-21.504c4.432,0.232,22.678,11.204,41.746,21.563c35.398,19.229,69.457,34.595,75.896,34.239c12.609-1.457-0.701-11.783-8.072-24.217c-7.049-11.892-15.414-29.572-18.844-42.134s-4.723-22.272-8.91-27.091c-2.143-2.463-12.812-6.786-21.189-8.146c-18.045-2.933-22.191-2.922-13.531-8.957c13.076-9.115,17.377-11.039,1.826-29.068c-6.383-7.402-11.336-20.003-13.709-39.542c-1.607-13.237,1.057-23.679-3.869-27.451s-17.271,12.341-20.846,19.334c-2.01,3.937-7.102,19.005-11.312,33.485c-13.795,47.427-29.865,65.742-62.693,71.447c-34.361,5.971-71.623-9.506-116.543-48.404c-13.164-11.399-29.533-25.26-39.254-36.913c-13.428-16.101-15.48-18.138-19.785-20.66c-16.166-9.472-54.98-31.694-103.525-63.815c-24.393-16.141-57.72-36.928-71.453-43.693c-27.236-13.417-68.416-28.952-90.731-46.771c-24.665-19.697-38.108-19.793-67.804-5.479c-21.429,10.328-23.941,15.298-26.52,15.726c-8.216-10.129-22.917-11.198-31.647-20.682c-9.529-10.35-28.027-14.098-37.824-24.957c-10.668-11.826-31.25-16.752-40.886-26.94c-11.339-11.989-29.387-16.096-40.838-26.637c-11.617-10.694-27.159-14.843-37.68-24.045c-10.383-9.082-23.187-12.538-31.408-19.163c-8.193-6.601-16.593-9.444-22.026-11.993c-5.433-2.549-7.398-2.522-7.658-1.927c-0.26,0.594,1.355,2.955,6.054,6.447c4.699,3.491,22.193,18.451,31.645,22.77c10.921,5.104,17.502,15.01,29.671,21.375c13.224,6.918,22.212,18.731,36.229,25.924c15.53,7.971,24.754,21.184,39.657,28.253c16.462,7.808,25.503,21.598,39.958,28.36c14.499,6.78,20.647,20.252,34.429,23.428C-238.033,58.207-227.932,70.443-220.02,76.509L-220.02,76.509z").transition().delay(300).duration(2e3).attr("opacity",1)})}(),function(){function a(a){var b=[];return-1!=["top","middle","bottom"].indexOf(a.legend.vAlign)?b.push(a.legend.vAlign):b.push("top"),-1!=["left","center","right"].indexOf(a.legend.hAlign)?b.push(a.legend.hAlign):b.push("right"),"vertical"===a.legend.direction&&b.push("vertical"),b}function b(b,c,d){var e=this.container.selectAll(".contour-legend").data([null]),f=_.nw.textBounds("series",".contour-legend.contour-legend-entry"),g=b.length,h=(f.height+4)*g+12,i=(d.chart.plotHeight-h)/2,j=function(a){if("center"===d.legend.hAlign&&a.length){var b=a[0].parentNode.clientWidth,c=(d.chart.plotWidth-b)/2+d.chart.internalPadding.left;d3.select(a[0].parentNode).style("left",c+"px")}},k=e.enter().append("div").attr("class",function(){return["contour-legend"].concat(a(d)).join(" ")}).attr("style",function(){var a=[];if("top"===d.legend.vAlign?a.push("top: 0"):"middle"===d.legend.vAlign?a.push("top: "+i+"px"):a.push("bottom: "+(d.chart.internalPadding.bottom+5)+"px"),"left"===d.legend.hAlign)a.push("left: "+d.chart.plotLeft+"px");else if("center"===d.legend.hAlign){var b=_.nw.textBounds(this,".contour-legend");a.push("left: "+((d.chart.plotWidth-b.width)/2+d.chart.internalPadding.left)+"px")}else a.push("right: 10px");return a.join(";")}),l=k.selectAll(".contour-legend-entry").data(b,function(a){return a.name});l.enter().append("div").attr("class",function(){return"contour-legend-entry"}),l.append("span").attr("class",function(a,b){return"contour-legend-key series s-"+(b+1)+" "+_.nw.seriesNameToClass(a.name)}),l.append("span").attr("class","series-name").text(d.legend.formatter).call(j),l.exit().remove()}var c={legend:{vAlign:"middle",hAlign:"right",direction:"vertical",formatter:function(a){return a.name}}};b.defaults=c,Contour.export("legend",b)}(),function(){function a(a,d,f){function g(a){return function(b,c){return(a||"")+" s-"+(c+1)+" "+_.nw.seriesNameToClass(b.name)}}function h(){var a=d3.svg.line().x(function(a){return k(a)}).y(function(){return l({x:0,y:f.yAxis.min||0})}),b=d3.svg.line().x(function(a){return k(a)}).y(function(a){return l(a)});f.line.smooth&&b.interpolate("cardinal");var h=e[c],i=d.selectAll("g.series").data(n,function(a){return a.name}),j=i.enter().append("svg:g").attr("class",g("series")).append("path").attr("class","line");if(m){var o="left-to-right"===c?b:a;j.attr("d",function(a){return o(a.data)}).call(_.partial(h.enter,b))}else j.attr("d",function(a){return b(a.data)});j=i.attr("class",g("series")).select(".line"),m?j.call(_.partial(h.update,b)):j.attr("d",function(a){return b(a.data)}),m?i.exit().remove():i.exit().remove()}function i(){var a=d.selectAll(".line-chart-markers").data(n,function(a){return a.name});a.enter().append("g").attr("class",g("line-chart-markers markers")),a.exit().remove();var c=a.selectAll(".dot").data(function(a){return a.data},function(a){return a.x});c.enter().append("circle").attr("class","dot").attr("r",f.line.marker.size).attr("opacity",0),c.exit().remove(),m?c.transition().delay(b).attr("cx",k).attr("cy",l).attr("opacity",1):c.attr("cx",k).attr("cy",l).attr("opacity",1)}function j(){var a=10,b=d.selectAll(".tooltip-trackers").data(n,function(a){return a.name});b.enter().append("g").attr("class",function(a,b){return"tooltip-trackers s-"+(b+1)}),b.exit().remove();var c=b.selectAll(".tooltip-tracker").data(function(a){return a.data},function(a){return a.x});c.enter().append("circle").attr({"class":"tooltip-tracker",r:a,opacity:0}),c.attr({cx:k,cy:l}),c.exit().remove()}this.checkDependencies("cartesian");var k=_.bind(function(a){return this.xScale(a.x)+this.rangeBand/2+.5},this),l=_.bind(function(a){return this.yScale(a.y)+.5},this);f.chart.plotHeight;var m=f.chart.animations&&f.chart.animations.enable;c=f.line.animationDirection||"left-to-right",b=null!=f.chart.animations.duration?f.chart.animations.duration:400;var n=_.map(a,function(a){return _.extend(a,{data:_.filter(a.data,function(b,c){if(0===c&&null!=b.y)return!0;var d=k(a.data[c-1])!==k(b);return null!=b.y&&d})})});return h(),f.line.marker.enable&&i(),f.tooltip&&f.tooltip.enable&&j(),this}var b,c,d={line:{smooth:!1,animationDirection:"left-to-right",marker:{enable:!0,size:3}}},e={"left-to-right":{enter:function(){var a=this;a.each(function(){var a=this.getTotalLength();d3.select(this).attr("stroke-dasharray",a+" "+a).attr("stroke-dashoffset",a).transition().duration(b).ease("linear").attr("stroke-dashoffset",0)})},update:function(a){this.attr("d",function(b){return a(b.data)}),this.each(function(){var a=this.getTotalLength();d3.select(this).attr("stroke-dasharray",a+" "+a).attr("stroke-dashoffset",a).transition().duration(b).ease("linear").attr("stroke-dashoffset",0)})}},"bottom-to-top":{enter:function(a){this.transition().duration(b).attr("d",function(b){return a(b.data)})},update:function(a){this.transition().duration(b).attr("d",function(b){return a(b.data)})}}};a.defaults=d,Contour.export("line",a)}(),Contour.export("nullVis",_.noop),function(){function a(a,b,c){function d(a){function b(a){var b=d3.interpolate(this._current,a);return this._current=b(0),function(a){return c(b(a))}}var c=d3.svg.arc().outerRadius(l).innerRadius(m),d=d3.svg.arc().outerRadius(l).innerRadius(m).startAngle(0).endAngle(0),g=a.selectAll("path").data(function(a){return o(a.data)},function(a){return a.data.x});g.enter().append("path").attr("class",n).attr("d",function(a){return d(a)}).each(function(a){this._current={startAngle:a.startAngle,endAngle:a.startAngle}}),f?(g.exit().remove(),g.transition().duration(e).ease("cubic-in").attrTween("d",b)):(g.exit().remove(),g.attr("d",c))}var e=null!=c.chart.animations.duration?c.chart.animations.duration:400,f=c.chart.animations&&c.chart.animations.enable,g=c.chart.plotWidth,h=c.chart.plotHeight,i=_.nw.clamp(_.nw.getValue(c.pie.piePadding,0,this),0,h/2-2),j=a.length,k=Math.min(g/j,h)/2-i,l=_.nw.getValue(c.pie.outerRadius,k,this,k),m=_.nw.getValue(c.pie.innerRadius,0,this,l),n=function(a,b){return"series arc"+(c.tooltip.enable?" tooltip-tracker":"")+" s-"+(b+1)+" "+a.name},o=d3.layout.pie().value(function(a){return a.y}).sort(null),p=function(a,b){var c=2*l+i;return"translate("+(l+i+c*b)+","+(l+i)+")"},q=b.selectAll("g.pie-group").data(a);q.enter().append("svg:g").attr("class","pie-group").attr("transform",p).call(d),q.exit().remove(),f?q.call(d).transition().duration(e/2).attr("transform",p):q.call(d).attr("transform",p)}var b={pie:{piePadding:1,innerRadius:null,outerRadius:null}};a.defaults=b,Contour.export("pie",a)}(),function(){function a(a,b,c){this.checkDependencies("cartesian");var d=null!=c.chart.animations.duration?c.chart.animations.duration:400,e=c.chart.animations&&c.chart.animations.enable,f=c.scatter,g=this.rangeBand/2,d=400,h=_.bind(function(a){return this.xScale(a.x)+g},this),i=_.bind(function(a){return this.yScale(a.y)},this),j=c.chart.plotHeight,k=function(a,b){return a.name+" series s-"+(b+1)},l=b.selectAll(".series").data(a);l.attr("class",k),l.enter().append("svg:g").attr("class",k),l.exit().remove();var m=l.selectAll(".dot").data(function(a){return a.data},function(a){return c.scatter.dataKey?a[c.scatter.dataKey]:a.x});m.enter().append("circle").attr("class","dot tooltip-tracker").attr("r",f.radius).attr("cx",h).attr("cy",j),e?m.transition().duration(d).attr("r",f.radius).attr("cx",h).attr("cy",i):m.attr("r",f.radius).attr("cx",h).attr("cy",i),m.exit().remove()}var b={xAxis:{type:"linear"},scatter:{radius:4}};a.defaults=b,Contour.export("scatter",a)}(),function(){Contour.export("stackTooltip",function(a,b,c){var d=this.yAxis().tickFormat(),e=d3.select(c.stackTooltip.el);e.classed("stack-tooltip",!0);var f=function(b){var f=function(a){return!(a&&null!=a.y)},g=function(a,d){var e=_.isNumber(b.x)?b.x:c.xAxis.categories.indexOf(b.x);return f(a.data[e])?null:{seriesName:a.name,value:a.data[e].y,cssClass:"s-"+(d+1)}},h=_.filter(_.map(a,g),function(a){return a}),i=_.map(h,function(a){return'<span class="'+a.cssClass+'"">'+a.seriesName+": "+d(a.value)+"</span>"}).join(" / ");e.html(i).style({display:"block"})},g=function(){e.html("")};this.svg.selectAll(".tooltip-tracker").on("mouseover.tooltip",f.bind(this)).on("mouseout.tooltip",g.bind(this))})}(),function(){function a(a,b,c){function d(b){var c=[];return _.each(a,function(a){var d=a.name;_.each(a.data,function(a){a.x===b.x&&b.y===a.y&&c.push({x:a.x,y:a.y,series:d})})}),c}var e=function(){clearTimeout(this.tooltip.hideTimer)},f=function(a,b){this.options.tooltip.animate?this.tooltipElement.transition().duration(b).style("opacity",a):this.tooltipElement.style("opacity",a)},g=function(a){var b=a.getBoundingClientRect();return a.getBoundingClientRect(),[b.left+b.width/2,b.top+b.height/2]},h=function(a){var b,d=function(){return"path"===d3.event.target.tagName?g(d3.event.target):d3.mouse(this.container.node())},e=this.xScale,f=this.yScale,h=this.options.chart.plotLeft,i=this.options.chart.plotWidth,j=this.options.chart.plotTop,k=this.options.chart.plotHeight,l=this.options.tooltip.distance,m=parseFloat(this.tooltipElement.style("width")),n=parseFloat(this.tooltipElement.style("height")),o=e?e(a.x):d()[0],p=f?f(a.y):d()[1],q=function(a){return a.x<h&&(a.x=h+l),a.x+m>h+i&&(a.x-=a.x+m-(h+i),a.y=j+p-(n+l),b=!0),a.y<j&&(a.y=j+l,b&&p>=a.y&&p<=a.y+n&&(a.y=p+j+l)),a.y+n>j+k&&(a.y=Math.max(j,j+k-(n+l))),a},r={vertical:function(){var a={x:h+o-(l+m),y:j+p-(l+n)};return q(a)},horizontal:function(){var a={x:h+p-(l+m),y:j+o-(l+n)};return q(a)}};return c.chart.rotatedFrame?r.horizontal():r.vertical()},i=function(a){l.call(this,a)},j=function(){f.call(this,0,this.options.tooltip.hideTime)},k=function(a,b){function c(){var a=Array.prototype.slice.call(arguments),b=a[0],c=a.slice(1),d=_.map(b,function(a){return a.apply(this,c)}).concat([_.noop]);return _.first(_.select(d))}var d=this.options.tooltip,e=[function(a){return d.formatter?_.partial(d.formatter,a,b):null},function(a){return a.hasOwnProperty("x")?_.partial(function(a){return a.series+"<br>"+a.x+"<br>"+a.y},a):null},function(a){return a.data&&a.data.hasOwnProperty("x")?_.partial(function(a){return a.series+"<br>"+a.x+"<br>"+a.y},a.data):null},function(a){return a.hasOwnProperty("value")?_.partial(function(a){return a.value},a):null},function(){return function(){return"NA"}}];return c(e,a)()},l=function(a){e.call(this),dataPoints=d(a),this.tooltipElement.select(".text").html(k.call(this,dataPoints[0],dataPoints));var b=h.call(this,a);this.tooltipElement.style("top",b.y+"px").style("left",b.x+"px"),f.call(this,this.options.tooltip.opacity,this.options.tooltip.showTime)};this.tooltipElement=this.container.style("position","relative").selectAll(".nw-tooltip").data([1]),this.tooltipElement.enter().append("div").attr("class","nw-tooltip").style("opacity",0).append("div").attr("class","text"),this.svg.selectAll(".tooltip-tracker").on("mouseover.tooltip",i.bind(this)).on("mouseout.tooltip",j.bind(this))}var b={tooltip:{enable:!0,animate:!0,opacity:.85,showTime:300,hideTime:500,distance:5}};a.defaults=b,Contour.export("tooltip",a)}(),function(){function a(a,b,c){this.checkDependencies("cartesian");var d=null!=c.chart.animations.duration?c.chart.animations.duration:400,e=c.chart.animations&&c.chart.animations.enable,f=_.bind(function(a){return this.xScale(a)+this.rangeBand/2},this),g=_.bind(function(a){return this.yScale(a)},this),h=_.nw.linearRegression(_.flatten(_.pluck(a,"data"))),i=d3.extent(this.xScale.domain()),j=function(a){return h.intercept+h.slope*a},k=b.selectAll(".trend-line").data([1]);k.enter().append("line").attr("class","trend-line").attr("x1",f(i[0])).attr("y1",g(j(i[0]))).attr("x2",f(i[0])).attr("y2",g(j(i[0]))),k.exit().remove(),e?k.transition().duration(d).attr("x1",f(i[0])).attr("y1",g(j(i[0]))).attr("x2",f(i[1])).attr("y2",g(j(i[1]))):k.attr("x1",f(i[0])).attr("y1",g(j(i[0]))).attr("x2",f(i[1])).attr("y2",g(j(i[1])))}a.defaults={},Contour.export("trendLine",a)}(),"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=Contour:(b.Contour=Contour,"function"==typeof define&&define.amd&&define("contour",[],function(){return Contour}))}();
//# sourceMappingURL=dist/contour.min.map